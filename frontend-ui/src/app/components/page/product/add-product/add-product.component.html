<!-- src/app/page/product/add-product/add-product.component.html -->
<main class="main-content" [class.collapsed]="isSidebarCollapsed">
  <div class="container-fluid">
    <div class="card mt-4 shadow-sm border-0">
      <div class="card-header">
        <h5 class="mb-0">Add New Product</h5>
      </div>
      <div class="card-body">
        <!-- Alert Message -->
        <div *ngIf="message" class="mb-3">
          <div [ngClass]="{
              'alert alert-success': message.type === 'success',
              'alert alert-danger': message.type === 'error'
            }">
            {{ message.text }}
          </div>
        </div>

        <!-- Form -->
        <form (ngSubmit)="onSubmit()" #productForm="ngForm" enctype="multipart/form-data" class="row g-3">
          
          <!-- Product Images -->
          <div class="col-12">
            <label class="form-label">Product Images</label>
            <input type="file" 
                   class="form-control" 
                   (change)="onImageSelect($event)"
                   multiple
                   accept="image/*">
            <div class="form-text">You can select multiple images</div>
            
            <!-- Selected Images Preview -->
            <div *ngIf="selectedImages.length > 0" class="mt-3">
              <h6>Selected Images:</h6>
              <div class="d-flex flex-wrap gap-2">
                <div *ngFor="let image of selectedImages; let i = index" class="image-preview-container">
                  <img [src]="getImageUrl(image)" class="image-preview">
                  <button type="button" class="btn-close btn-close-white remove-image-btn" 
                          (click)="removeImage(i)" title="Remove image"></button>
                </div>
              </div>
            </div>
          </div>

          <!-- Product Name -->
          <div class="col-md-6">
            <label class="form-label">Product Name *</label>
            <input type="text" 
                   class="form-control" 
                   [(ngModel)]="product.name" 
                   name="name" 
                   required>
          </div>

          <!-- Category -->
          <div class="col-md-6">
            <label class="form-label">Category *</label>
            <input type="text" 
                   class="form-control" 
                   [(ngModel)]="product.category" 
                   name="category" 
                   required>
          </div>

          <!-- Description -->
          <div class="col-12">
            <label class="form-label">Description</label>
            <textarea class="form-control" 
                      [(ngModel)]="product.description" 
                      name="description"
                      rows="3"></textarea>
          </div>

          <!-- Price -->
          <div class="col-md-6">
            <label class="form-label">Price *</label>
            <div class="input-group">
              <span class="input-group-text">$</span>
              <input type="number" 
                     class="form-control" 
                     [(ngModel)]="product.price" 
                     name="price"
                     min="0"
                     step="0.01"
                     required>
            </div>
          </div>

          <!-- Cost Price -->
          <div class="col-md-6">
            <label class="form-label">Cost Price</label>
            <div class="input-group">
              <span class="input-group-text">$</span>
              <input type="number" 
                     class="form-control" 
                     [(ngModel)]="product.costPrice" 
                     name="costPrice"
                     min="0"
                     step="0.01">
            </div>
          </div>

          <!-- Stock -->
          <div class="col-md-6">
            <label class="form-label">Stock Quantity</label>
            <input type="number" 
                   class="form-control" 
                   [(ngModel)]="product.stock" 
                   name="stock"
                   min="0">
          </div>

          <!-- Status -->
          <div class="col-md-6">
            <label class="form-label">Status</label>
            <select class="form-select" 
                    [(ngModel)]="product.status" 
                    name="status">
              <option value="ACTIVE">Active</option>
              <option value="INACTIVE">Inactive</option>
              <option value="OUT_OF_STOCK">Out of Stock</option>
            </select>
          </div>

          <!-- Delivery Required -->
          <div class="col-12">
            <div class="form-check">
              <input type="checkbox" 
                     class="form-check-input" 
                     [(ngModel)]="product.isDeliveryRequired" 
                     name="isDeliveryRequired">
              <label class="form-check-label">Delivery Required</label>
            </div>
          </div>

          <!-- Error Message -->
          <div *ngIf="error" class="col-12">
            <div class="alert alert-danger" role="alert">
              {{ error }}
            </div>
          </div>

          <!-- Form Actions -->
          <div class="col-12">
            <div class="d-flex gap-2">
              <button type="button" class="btn btn-outline-secondary" (click)="cancel()">
                <i class="fas fa-arrow-left me-2"></i>Back to Products
              </button>
              <button type="submit" 
                      class="btn btn-primary" 
                      [disabled]="!isFormValid() || loading">
                <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                {{ loading ? 'Creating...' : 'Create Product' }}
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</main>